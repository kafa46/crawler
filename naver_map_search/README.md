# 네이버 맵을 이용한 크롤러

네이버 맵(https://map.naver.com/)에서 제공하는 기능을 활용하여 원하는 장소 정보를 수집하는 웹 크롤러입니다.

이 크롤러의 소프트웨어 구조는 `software_structure.md` 파일(바로가기: [클릭](software_structure.md))을 참고하기 바랍니다.

## 의존성 (Dependencies)

이 소프트웨어는  2개 패키지에 의존하고 있습니다.

- `requests`:  프로그래밍을 통해 HTTP request를 편리하게 조작할 수 있는 파이썬 라이브러리 입니다.
  - 공식 홈페이지: https://requests.readthedocs.io/en/latest/
  - 설치 방법: `pip install requests` 
    - 참고 웹페이지: pypi.org [requests](https://pypi.org/project/requests/)
- `geopy`: 프로그래밍을 통해 주소, 도시, 국가, 랜드마크 등의 지리 좌표 정보를 조작할 수 있는 파이썬 라이브러리 입니다. 
  - 공식 홈페이지: https://geopy.readthedocs.io/en/stable/
  - 설치 방법: `pip install geopy`
    - 참고 웹페이지: pypi.org [geopy](https://pypi.org/project/geopy/)

`pip` 활용하여 일괄 설치하기 위해서는 아래와 같이 명령어를 실행합니다.

```bash
pip install -r requirement.txt
``` 

## 옵션 (Options)

커맨드 라인 (command line) 명령어를 통해 다양한 옵션을 부여할 수 있습니다. 

옵션 설정에 따라 검색 방법, 검색 결과 수 등을 조절할 수 있습니다.

옵션 종류는 다음과 같습니다.

- `--keyword`: 지도 검색에 사용할 키워드를 지정합니다. 현재 위치로부터 지정한 키워드 가까운 장소를 순서대로 검색합니다. 지정하지 않을 경우 기본 입력값은 `지구대` 입니다.
- `--from_file`: 옵션이 플래그(지정)되면 검색할 현재 위치(위도, 경도) 정로를 파일로부터 읽어 옵니다.
  - 파일에 저장된 위치 정보는 반드시 `위도, 경도`와 같은 형태이어야 합니다(쉼표로 구분). 예를 들어 `location.txt` 내부에 저장된 내용은 `36.6525542, 127.4954839`와 같습니다.
- `--geo_fn`: 파일로부터 위치 정보를 읽어오기 위한 `--from_file` 옵션이 선택된 경우 파일 이름을 지정할 수 있습니다. 읽어올 파일 이름을 지정하지 않을 경우 현재 위치에서 `location.txt`라는 이름을 갖는 파일을 불러옵니다.
- `--from_ip`: 현재 위치는 사용하고 있는 디바이스(컴퓨터, 스마트폰, 태블릿 등)이 사용하고 있는 IP 주소를 추적하여 현재 위치를 설정합니다. 참고로 IP 추적 방식은 현재 위치에 오차가 발생할 수 있습니다.
- `--lat`: 사용자가 직접 현재 위치의 위도(latitude) 값을 입력할 수 있습니다.
- `--lng`: 사용자가 직접 현재 위치의 경도(longitude) 값을 입력할 수 있습니다.
- `--max_list`: 키워드 검색 결과의 최대 개수 지정할 수 있습니다. 지정하지 않을 경우 기본 입력값은 `10`개입니다(거리순으로 가장 가까운 10개 목록을 반환).
- `--save_fn`: 검색 결과 저장을 위한 파일 이름을 지정합니다. 지정하지 않을 경우 기본 입력값은 `result.csv`으로 현재 디렉토리에 결과를 저장합니다.

## 사용법 (Usage)

사용자의 요구에 따라 다양션을 조합하여 프로그램을 실행할 수 있습니다. 몇 가지 사용법을 기술하였으니 참고하기 바랍니다.

### 기본 옵션을 활용한 검색

현위치로부터 키워드를 활용한 검색을 수행하는 가장 간단한 방법은 기본 옵션을 사용하는 방법입니다. 기본옵션을 사용할때는 `--keyword`, `--from_file` 옵션만 사용하면 됩니다.

만약 `--keyword` 옵션만 지정할 경우 현재 디렉토리에서 `location.txt`라는 파일을 찾아서 현위치 정보를 업로드하고, 현위치로부터 키워드와 관련된 장소를 거리순으로 10개 검색합니다. 검색 결과는 현재 디렉토리에 `result.csv`라는 이름의 파일로 자동 저장됩니다.

키워드를 `횟집`으로 사용하고, 나머지 모든 작동은 기본값(default)으로 처리하고자 하는 경우에는 다음과 같이 명령어를 입력하면 됩니다.

```bash
python main.py --keyword 횟집
```

검색결과 콘솔(모니터)에 나타나는 결과는 다음과 같습니다. 

(Note: `location.txt` 파일에 저장된 현재 위치 좌표에 따라 결과는 달라집니다.)

```bash
>>> 현재 좌표 위치(이름): 대한민국 28503 충청북도 청주시 청원구 우암동 우암산로 경상대학

파일에 저장된 GPS 좌표를 사용하여 검색합니다.

>>> 현재 GPS 좌표:  위도: 36.6497542     경도: 127.4966839

>>> 입력 키워드: "횟집" --> 검색 결과(10)개
1 이름: 삼일회센타      위도: 36.6506358        경도: 127.4879225       전화번호: 043-223-1128  현위치로부터의 거리: 0.79 Km    주소: 충청북도 청주시 청원구 중앙로 150-1
2 이름: 삼일횟집        위도: 36.6506358        경도: 127.4879225       전화번호: 043-256-7181  현위치로부터의 거리: 0.79 Km    주소: 충청북도 청주시 청원구 중앙로 150-1
3 이름: 광어15000       위도: 36.6529936        경도: 127.4885399       전화번호: 043-255-9900  현위치로부터의 거리: 0.81 Km    주소: 충청북도 청주시 청원구 상당로 275
4 이름: 삼합회  위도: 36.6401828        경도: 127.4873278       전화번호:       현위치로부터의 거리: 1.35 Km    주소: 충청북도 청주시 상당구 사직대로361번길 74-2
5 이름: 자연수산회      위도: 36.6398995        경도: 127.4904669       전화번호: 043-221-8987  현위치로부터의 거리: 1.23 Km    주소: 충청북도 청주시 상당구 교동로3번길 55 충북인쇄조합
6 이름: 대박막회포차    위도: 36.6656516        경도: 127.4972118       전화번호: 043-211-5214  현위치로부터의 거리: 1.77 Km    주소: 충청북도 청주시 청원구 율량로190번길 25 1층
7 이름: 회포장  위도: 36.6571433        경도: 127.4837988       전화번호: 043-221-0501  현위치로부터의 거리: 1.41 Km    주소: 충청북도 청주시 청원구 내덕로 31 3동 1층
8 이름: 만선    위도: 36.6428250        경도: 127.4842639       전화번호: 043-256-0078  현위치로부터의 거리: 1.35 Km    주소: 충청북도 청주시 상당구 무심동로 474
9 이름: 울릉도회집      위도: 36.6557027        경도: 127.4823038       전화번호: 043-257-2650  현위치로부터의 거리: 1.44 Km    주소: 충청북도 청주시 청원구 내덕로 10
10 이름: 참치와친구들율량점     위도: 36.6647542        경도: 127.4978442       전화번호: 043-211-3782  현위치로부터의 거리: 1.67 Km    주소: 충청북도 청주시 청원구 율량로202번길 12

>>> 검색 결과는 현재 디렉토리 result.csv로 저장되었습니다.
```

### 파일에 저장된 정보 이용한 검색

검색어를 `편의점`으로 지정하고, 파일에 저장된 현재위치를 이용하여 5개의 목록을 거리순으로 추출하고자 할 경우

```bash
python main.py --keyword 편의점 --max_list 5  --from_file
```

위 명령어를 실행하면 모니터에 아래와 같은 검색 결과가 출력되고, 검색 결과는 현재 디렉토리에 `result.csv`라는 파일로 저장됩니다.

```bash
>>> 현재 좌표 위치(이름): 대한민국 28503 충청북도 청주시 청원구 우암동 우암산로 경상대학

파일에 저장된 GPS 좌표를 사용하여 검색합니다.

>>> 현재 GPS 좌표:  위도: 36.6497542     경도: 127.4966839

>>> 입력 키워드: "편의점" --> 검색 결과(5)개
1 이름: 이마트24 청주대수암점   위도: 36.6502430        경도: 127.4943575       전화번호: 043-253-3369  현위치로부터의 거리: 0.21 Km    주소: 충청북도 청주시 청원구 수암로88번길 14 호젠빌
2 이름: GS25 청주대타운점       위도: 36.6492990        경도: 127.4939840       전화번호:       현위치로부터의 거리: 0.25 Km    주소: 충청북도 청주시 청원구 수암로 78 1층
3 이름: 세븐일레븐 청주대중문점 위도: 36.6507823        경도: 127.4940799       전화번호: 043-221-1659  현위치로부터의 거리: 0.26 Km    주소: 충청북도 청주시 청원구 수암로 98-15
4 이름: GS25 청주대중문점       위도: 36.6510919        경도: 127.4938288       전화번호: 043-288-5951  현위치로부터의 거리: 0.3 Km     주소: 충청북도 청주시 청원구 수암로 98-3
5 이름: CU 청주대이공대점       위도: 36.6531853        경도: 127.4957084       전화번호: 1577-8700     현위치로부터의 거리: 0.39 Km    주소: 충청북도 청주시 청원구 대성로 298 (내덕동)
```

### 디바이스 IP 추적을 통한 검색

검색어를 `도서관`으로 지정하고, 컴퓨터의 IP를 추적하여 찾은 현재위치를 이용하여 3개의 목록을 거리순으로 추출하여 `library.txt`라는 파일로 저장하고자 하는 경우

```bash
python main.py --keyword 도서관 --max_list 3  --from_ip --save_fn library.txt
```

위 명령어를 실행하면 모니터에 아래와 같은 검색 결과가 출력되고, 검색 결과는 현재 디렉토리에 `result.csv`라는 파일로 저장됩니다. 

Note: 검색결과는 디바이스에 할당된 IP 주소에 따라 달라집니다.

```bash
>>> 현재 컴퓨터의 접속 정보
컴퓨터의 IP 주소: 203.252.240.43
접속 위치: South Korea North Chungcheong Cheongju-si
접속 기관: Chongju University
위도: 36.638, 경도: 127.4838

>>> 현재 좌표 위치(이름): 대한민국 28550 충청북도 청주시 상당구 영동

현재 컴퓨터가 사용하고 있는 IP를 참고하여 검색합니다.
주의!!! IP기반 추적은 오차가 존재합니다..

>>> 현재 GPS 좌표:  위도: 36.638         경도: 127.4838

>>> 입력 키워드: "도서관" --> 검색 결과(3)개
1 이름: 드림작은도서관  위도: 36.6335700        경도: 127.4843900       전화번호: 043-224-0877  현위치로부터의 거리: 0.5 Km     주소: 충청북도 청주시 상당구 남사로83번길 35 청주시사회복지협회
2 이름: 너,나, 우리도서관       위도: 36.6411446        경도: 127.4881350       전화번호:       현위치로부터의 거리: 0.52 Km    주소: 충청북도 청주시 상당구 상당로143번길 30
3 이름: 예꿈문고        위도: 36.6408900        경도: 127.4903800       전화번호: 043-253-0909  현위치로부터의 거리: 0.67 Km    주소: 충청북도 청주시 상당구 교동로3번길 81 임마누엘교회

>>> 검색 결과는 현재 디렉토리 library.txt로 저장되었습니다.
```

### 사용자가 위도, 경도를 입력하여 검색

사용자가 직접 좌표를 입력하여 `맛집` 검색하려고 할 경우는 다음과 같습니다. (최대 4개 검색, 검색 결과는 `delicious.csv`로 저장)

```bash
python main.py --keyword 맛집 --lat 36.636 --lng 127.4914 --max_list 4 --save_fn delicious.csv
```

위 코드를 실행한 결과는 콘솔(모니터에) 아래와 같이 출력되고, 현재 디렉토리에 `delicious.csv` 라는 파일로 저장됩니다.

```bash
>>> 현재 좌표 위치(이름): 대한민국 28716 충청북도 청주시 상당구 우암동 대성로 충청북도청

사용자가 터미널에 입력한 GPS 좌표값을 사용하여 검색합니다.

>>> 현재 GPS 좌표:  위도: 36.636         경도: 127.4914

>>> 입력 키워드: "맛집" --> 검색 결과(4)개
1 이름: 무심천드래곤    위도: 36.6392002        경도: 127.4879177       전화번호: 043-232-0939  현위치로부터의 거리: 0.47 Km    주소: 충청북도 청주시 상당구 상당로121번길 34 1층
2 이름: 카페공기        위도: 36.6309197        경도: 127.4917244       전화번호: 043-223-5732  현위치로부터의 거리: 0.57 Km    주소: 충청북도 청주시 상당구 상당로26번길 15-7
3 이름: 소로리  위도: 36.6399872        경도: 127.4893215       전화번호: 070-4792-0021 현위치로부터의 거리: 0.48 Km    주소: 충청북도 청주시 상당구 상당로131번길 7-2 1층 소로리
4 이름: 홈버드  위도: 36.6374707        경도: 127.4884273       전화번호: 010-4946-4122 현위치로부터의 거리: 0.31 Km    주소: 충청북도 청주시 상당구 중앙로 5-7 2층 홈버드

>>> 검색 결과는 현재 디렉토리 delicious.csv로 저장되었습니다.
```

크롤러 메인 페이지로 이동 ([클릭](../))
